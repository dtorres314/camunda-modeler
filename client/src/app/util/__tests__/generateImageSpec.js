/**
 * Copyright Camunda Services GmbH and/or licensed to Camunda Services GmbH
 * under one or more contributor license agreements. See the NOTICE file
 * distributed with this work for additional information regarding copyright
 * ownership.
 *
 * Camunda licenses this file to you under the MIT; you may not use this file
 * except in compliance with the MIT License.
 */

import generateImage from '../generateImage';

import { keys } from 'min-dash';

const EXCPECTED_JPEG_DATAURL = 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4gIoSUNDX1BST0ZJTEUAAQEAAAIYAAAAAAQwAABtbnRyUkdCIFhZWiAAAAAAAAAAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAAHRyWFlaAAABZAAAABRnWFlaAAABeAAAABRiWFlaAAABjAAAABRyVFJDAAABoAAAAChnVFJDAAABoAAAAChiVFJDAAABoAAAACh3dHB0AAAByAAAABRjcHJ0AAAB3AAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAFgAAAAcAHMAUgBHAEIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFhZWiAAAAAAAABvogAAOPUAAAOQWFlaIAAAAAAAAGKZAAC3hQAAGNpYWVogAAAAAAAAJKAAAA+EAAC2z3BhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABYWVogAAAAAAAA9tYAAQAAAADTLW1sdWMAAAAAAAAAAQAAAAxlblVTAAAAIAAAABwARwBvAG8AZwBsAGUAIABJAG4AYwAuACAAMgAwADEANv/bAEMAAwICAgICAwICAgMDAwMEBgQEBAQECAYGBQYJCAoKCQgJCQoMDwwKCw4LCQkNEQ0ODxAQERAKDBITEhATDxAQEP/bAEMBAwMDBAMECAQECBALCQsQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEP/AABEIAJAAkAMBIgACEQEDEQH/xAAdAAEBAAEFAQEAAAAAAAAAAAAACQcBAgQICgYD/8QANBAAAQMCBQMCBAYCAgMAAAAAAQIDBAAFBgcIERIJITETMhQiUZFBQlJhcYEzoRjBFRYj/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhEDEQA/AKp0pSgUpSgUpSgUpXHn3G32qMqbdJ0eHHR7nZDqW0J/lSiAKDkUrHVy1H6ebM4tq7585dQVtnZaZOKILRSf3CnRtS26jtPN5cQ1aM+cu5y3DshMbFEF0qP7BLp3oMi0rjwLjb7rGTNtk6PMjr9rrDqXEK/hSSQa5FApSlApSlApSlApSlApStq1oaQpxxaUIQCpSlHYADySaDdXWfU31BdPmmF5/D+Ib09iLFzaN/8A16y8XX2iR8vxDhIbjjuDso89juEKFdOteHVSuP8A5C5ZP6XL2liMxyi3TGUZW7jq/C27erwlI7j4jyT3b2AS4rCukHpkZp6kzHzJzXnz8HYJnLEpMl9vldbylR5FbCHPYhW+/ruAg7gpS4CSA/POnquaps45rlgy3WzgC1zHPRjxLCgv3J0KPypVKUOfPfbYspaNfB23Rdr7z+lov17y3xzdXnRz+PxdcfhnOJ/NvPdS4oH9gSatXkZpRyE0529EbKvLy32+bw4PXd9PxFxf3Gx5yV7rAPf5ElKBudkisuUEQbR0bNW9yabcmXPL+1KX5bl3l9Skfz6MdwfYml36Nmre2suOQ7nl/dVI8NxLy+lS/wCPWjtj7kVb6lB5+Ljow195AS136yZb45tTrQ5/H4RuPxLnEfm3gOqcSB57gEV95kt1XdUuTs1uwZkLYzAtcNz0ZES+oLFyaCTspKZSRz5777l5Dpq5dYjz00o5B6jbeuNmpl7b7hN4cGbuwn4e4sdthwkI2WQO3yKKkHYbpNB8Jpk6gunzU88zYMPXp7DuLXEbnD174svukDv8O4CW5A7E7JPPYblCRXZeob6vumVmpprU/mTlTPn4wwTBcMoyo6ON0syUnkFvob96E7b+u2ABxJUlsbE5u0HdVKeqfbcntUd6Q8w9xi2rGclWy0L8IbuCj2Uk9h8R2IOxc3BU4kKtUrahaHEJcbWFIUApKkncEHwQa3UClKUClKUCpT9VDXnLTLuWlzJ29htpCVRsZXWK58ylHsq2trHgAf5iO5J9Lts4k9xNf+ps6YNP1zxHZZKEYtxCs2XDqexU3JcQSuTt9GWwpfcEc/TSfdUy+mPpEGpPNaXmnmTCcn4JwbKTIkpkgrTeLqo8246yr3oTv6roO+4LaSNnCaDNPTe6bcK8wrXqE1DWEuxXSiZhrDMxv5HkdlImS0H3IPYttHsobKUCkgGrwAAAA2AoAAAANgK1oFKUoFKUoFKUoNCAoFKgCD2INSg6kPTbhWWFdNQmnmwlmIzzl4lwzDb+RhHlcyIge1A7lxodkjdSdkggVgrQgKBSoAg9iDQSp6V2vKW5KtulvOG9eo2tIj4Nu0pz5kqHttriz5BH+EnuCPS77tpFV6hr1NtIo01ZsRM0MtobsDBOMZKpMQRt0Js90SebkdBT7EH/ACtbbbALSBs3uacaAtTf/KDT9bMS3mQhWLLAsWXESBsC5JbQCiTt9HmylfYAc/USPbQdkqUpQKUrj3GfGtdvk3Oa5wjw2Vvuq/ShCSpR+wNBDzqyZyzc2NU68urM+7KteX8ZuyRY7W6kuXB7i5KUlI78ypTTJH1jj+626TMjIGnTIDCOV0dhCJ8KEmTeHU7Ev3J4c5KiR5AWShP0QhA/CotaOrXL1Ha/cLX7ELQcXdsVy8Y3EL+ZPJlTs4pV9QXEJRt4PL6V6A6BSlKBSlKBSlKBSlKBSlKDD+rXIyDqL0/4uyvfYQu4TISpVncVsCzcmf8A6R1An2grAQo/oWsfjUlukznLMyp1Spy5vD7sW15gRXLNJYd3Slu4s8nIylJ88+SXWQPq+auTXn71gWyXpu1/Ypv2HmQ2uz4siYwtyUfKnd5TU8JT9Eha1I28Djt4oPQJSuPAmxrnBjXKG5zjy2kPtK/UhQBSfsRXIoFY71HXJdm085oXhtwoXBwZe5KVA7FJRBeUD/qsiVjrUfbnLxp5zRtLTZcXNwZe4yUAblRXBeSB/ugkT0abUzcdWtwmON8lWvBtwltn9KjIiM7/AGeI/urd1EPo1XVm3atrhEdcCVXPBtwiNj9ShIiu7fZpR/qreUClKUClKUClKUClKUClKUCog9ZO1M27VvCltNhKrpg63S3D+pQflM7/AGZA/qrfVELrJ3Zm46t4UNtzkq14Ot0RwfpUX5T232eB/ugr5p3uS7zp/wAsru44VrnYOsslSidyorhNKJ/3WQax5pztrlm0+ZYWh1strg4NssZSCNikogspI/1WQ6BXHnwY1zgSbbNbDkeWyth1B/MhSSlQ+xNcilB5/NHN0lac9f2FrDfnQ2q04smYOuBX8qeTynYJUr6AOLSrfwOP0r0B1DHqv5OTso9VbuYVlZdiWzHzDd9iSGt0hu4NcW5SUq88wtLbx+nxA/quelPPK26ishMJZpw3kKmXCEli7NJ2Bj3FocJKCPwHqAqT9UKQfxoMt0pSgUpSgUpSgUpSgUpSgV5+9YFzk6jtf+KbFYng4bxi6Jg6ApHzJ3ZU1ACk/UFaFL38Hlv4q1Gq/PK3adMg8W5pS30JmwISo9oaVsS/cnvkjIAPkcyFK+iELP4VI/pPZNTc2tVDeYd5YdlWvL+O5fJch3dQcuDvJuKlSvPPmpx4H8fhz/YXFgw41uhR7fDaDceK0hlpA8JQkAJH9ACv3pSgUpSg61a/9MJ1Q5A3HDtkjoVi7DyzecOqOwLkhCCFxtz4DyCUdyAF+mo9k1MzpjavBptzVl5W5kTXIOCcZSUR5KpJKE2i6pPBuQsK9iFf4nSdttm1EgNkG5FSj6pugmWibc9UWTll9WO8DJxjaIrfzNr/ADXFpA8pPl4DuCC73BcKQq2CCAQdwa1qUXTe6kcO0w7Xp61C30tR2uEPDWJpbnyNI8Ihy1n2pHYNunsBslWwAIq4CCNwdwaDWlKUClKUClKUCtCQASTsBQkAEk7AVKDqQ9SSHeod0096eb8XYjpXDxLiaG58j6PC4cRY9yD3Djo7KG6U7pJJDC3U31d/8k814uVuW81ydgnBspceKYxK03i6qPpuSEBPvQnctNbb7grUDs5sKbaAtMP/ABdyAt2G71HbGLcQLF5xGsbEtyXEgIjBQ8pZQEo7Egr9RQ7Krpx0stBMszLZqhzksgbZaCZWDbTKb+Za/Kbk6g+APLIPck+r2AbKqtUClKUClKUCtq0IdQptxCVoWClSVDcEHyCK3UoJU68eldKdl3LOHS5ZULQ5ylXXBkdOykq8rdt48EHyY/bbv6e+6Wxg3SP1OM2dNnoZcZp2+djPBkFwRRFkuFF1s6UniUMOOe9KfHoubAcQlKmxvVyK636mNAmnvU9614xPh9dhxWtOycRWXixKWdu3rpIKJA7AfOkr2GyVJoPrsjNXWnzUVBZeyyzFt0m4uJ3cs0xYi3Jk7bkGOshSgP1I5I+ijWYqhxnJ0ktUeWM5+55cot+YNpjr9RiRan0xZ6Ug9lKjOqB57/g0tw/9Y8tWrTXxpmmow1eMe48sS2hxTbMXQVSQED8qET21KSnxtw2/ag9BVKiDaOsnq3trTbcy15fXVSPLkuzPpUv+fRkNj7AUu/WT1b3JpxuHbMv7UpfhyJZn1KR/HrSHB9waC31Ycz01eafNOsF57M3MW3Rri2nduyw1iVcnTtuAI6CVJB/Uvij6qFRYuurPXxqZmrw3Z8e49vy3RwVbMIwVRgUH8q0QG0lSfO/Pft5rIeTfSR1RZmzmLlmOi35fWmQv1H5F0fTKuCkk91IjNKJ57/g6ts/9hs1c9TbNnUr6+W+V1um4NwXPc+FMSM4V3S8JUeIQ+4j2pV49BvseRClODbbOug/pWyWZdtzh1R2ZCUt8ZVqwZITyJV5Q7cB4AHkR++/b1NtlNnuLpo0C6e9MPo3jC+Hl33FaEbLxFeuL8pB27+gnYIjjuR8iQrY7KUquyFBtQhDaEttoSlCQEpSkbAAeABW6lKBSlKBSlKBSlKBSlKBXHn2633WMqFdIMeZHX7mpDSXEK/lKgQa5FKDHVy04aebwtbt3yGy6nLcO61ScLwXSo/uVNHelt04aebM4h20ZDZdQVtndCo2F4LRSf2KWhtWRaUHHgW632uMmFbIMeHHR7WmGktoT/CUgAVyKUoFKUoFKUoFKUoP/2Q==';

const EXPECTED_PNG_DATAURL = 'data:image/png;base64,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';

const expectedImagesByType = {
  png: EXPECTED_PNG_DATAURL,
  jpeg: EXCPECTED_JPEG_DATAURL
};

describe('util - generateImage', function() {

  const svg = require('./diagram.svg'),
        outOfBoundsSVG = require('./out_of_bounds_diagram.svg');

  keys(expectedImagesByType).forEach(function(type) {

    it('should export <' + type + '>', async function() {

      const image = await generateImage(type, svg);

      expect(image).to.exist;
    });


    it('should automatically handle large images <' + type + '>', async function() {

      const image = await generateImage(type, outOfBoundsSVG);

      // if image cannot be generated properly it returns a data string with
      // 6 characters. If it is generated, image.length returns the actual size
      // of the generated image which is more than 6.
      expect(image.length).to.be.greaterThan(6);
    }).timeout(10000); // downscaling may exceed the default timeout 2000ms.


    it('should generate expected images <' + type + '>', async function() {

      const image = await generateImage(type, svg),
            expectedImage = expectedImagesByType[ type ];

      expect(image).to.be.eql(expectedImage);
    });
  });

});
